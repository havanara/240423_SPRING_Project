mysql -uroot -pezen

-- database 생성
create database springtest;

-- user 생성
create user 'springUser'@'localhost' identified by 'mysql';

-- 권한 부여
grant all privileges on springtest.* to 'springUser'@'localhost';

-- 권한 설정 메모리 반영
flush privileges;

-- 2024-04-23

create table board(
bno int auto_increment,
title varchar(200),
writer varchar(200),
content text,
isDel varchar(10) default 'N',
reg_date datetime default now(),
read_count int default 0,
primary key(bno));

-- 2024-04-25
create table member(
id varchar(100),
pw varchar(256) not null,
name varchar(100),
email varchar(100),
home varchar(100),
age int,
reg_date datetime default now(),
last_login datetime default now(),
primary key(id));

-- 2024-04-26
create table comment(
cno int auto_increment,
bno int not null,
writer varchar(100) not null,
content varchar(500),
reg_date datetime default now(),
primary key(cno));

-- 2024-04-29
create table file(
uuid varchar(256) not null,
save_dir varchar(256) not null,
file_name varchar(256) not null,
file_type tinyint(1) default 0,
file_size int,
bno int,
reg_date datetime default now(),
primary key(uuid));

-- 2024-04-30
-- 댓글 수와 파일 수 칼럼 추가
alter table board add cmt_qty int default 0;
alter table board add has_file int default 0;

-- bno가 일치하는 comment의 count를 세어서 cmt_qty 업데이트
update board
set cmt_qty = (
select count(bno) from comment
where bno = board.bno);

-- bno가 일치하는 file의 count를 세어서 has_file 업데이트
update board
set has_file = (
select count(bno) from file
where bno = board.bno);

spring_test2
insert into auth_user values ('kim@naver.com', 'ROLE_ADMIN');
