<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.ezen.www.repository.BoardDAO">
  
 <insert id="insert">
	insert into board(title, writer, content)
	values (#{title}, #{writer}, #{content})
 </insert>
 
 <select id="getList" resultType="com.ezen.www.domain.BoardVO">
 	select * from board
 	where isDel = 'N'
 	<include refid="search"></include>
  	order by bno desc
  	limit #{pageStart}, #{qty}
 </select>
 
<!--  <select id="getList" resultType="com.ezen.www.domain.BoardVO">
 	select * from board
 	where isDel = 'N'
  	order by bno desc
 </select> -->
 
 <select id="getDetail" resultType="com.ezen.www.domain.BoardVO">
 	select * from board where bno = #{bno}
 </select>
 
 <update id="update">
 	update board set title=#{title}, content=#{content} where bno = #{bno}
 </update>
 
 <update id="delete">
 	update board set isDel = "Y"
 	where bno = #{bno}
 </update>
 
 <select id="getTotal" resultType="int">
 	select count(bno) from board
 	where isDel = "N"
 	<include refid="search"></include> <!-- 연결할 아이디는 검색라인 search / refid="search" -->
 </select>
 
 <!-- 검색 라인 -->
 <sql id="search">
 	<if test="type!=null"> <!-- type이 null이면 검색을 안하겠다는 뜻! -->
 		<trim prefix="and (" suffix=")" suffixOverrides="or">
 			<foreach collection="typeToArray" item="type">
 				<trim suffix="or">
 					<choose>
 						<when test="type == 't'.toString()">
 							title like concat('%',#{keyword},'%')
 						</when>
 						<when test="type == 'w'.toString()">
 							writer like concat('%',#{keyword},'%')
 						</when>
 						<when test="type == 'c'.toString()">
 							content like concat('%',#{keyword},'%')
 						</when>
 					</choose>
 				</trim>
 			</foreach>
 		</trim>
 	</if>
 </sql>
  
</mapper>